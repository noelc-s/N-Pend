function [V,Vd] = energy(q,p)
V =(p.l(1)^2*p.m(1)*q(4)^2)/2 - (981*p.l(1)*p.m(2)*cos(q(1)))/100 - (981*p.l(1)*p.m(3)*cos(q(1)))/100 - (981*p.l(2)*p.m(2)*cos(q(2)))/100 - (981*p.l(2)*p.m(3)*cos(q(2)))/100 - (981*p.l(3)*p.m(3)*cos(q(3)))/100 - (981*p.l(1)*p.m(1)*cos(q(1)))/100 + (p.l(1)^2*p.m(2)*q(4)^2)/2 + (p.l(1)^2*p.m(3)*q(4)^2)/2 + (p.l(2)^2*p.m(2)*q(5)^2)/2 + (p.l(2)^2*p.m(3)*q(5)^2)/2 + (p.l(3)^2*p.m(3)*q(6)^2)/2 + p.l(1)*p.l(2)*p.m(2)*q(4)*q(5)*cos(q(1) - q(2)) + p.l(1)*p.l(2)*p.m(3)*q(4)*q(5)*cos(q(1) - q(2)) + p.l(1)*p.l(3)*p.m(3)*q(4)*q(6)*cos(q(1) - q(3)) + p.l(2)*p.l(3)*p.m(3)*q(5)*q(6)*cos(q(2) - q(3));
Vd(1) =(981*p.l(1)*p.m(1)*sin(q(1)))/100 + (981*p.l(1)*p.m(2)*sin(q(1)))/100 + (981*p.l(1)*p.m(3)*sin(q(1)))/100 - p.l(1)*p.l(2)*p.m(2)*q(4)*q(5)*sin(q(1) - q(2)) - p.l(1)*p.l(2)*p.m(3)*q(4)*q(5)*sin(q(1) - q(2)) - p.l(1)*p.l(3)*p.m(3)*q(4)*q(6)*sin(q(1) - q(3));
Vd(2) =(981*p.l(2)*p.m(2)*sin(q(2)))/100 + (981*p.l(2)*p.m(3)*sin(q(2)))/100 + p.l(1)*p.l(2)*p.m(2)*q(4)*q(5)*sin(q(1) - q(2)) + p.l(1)*p.l(2)*p.m(3)*q(4)*q(5)*sin(q(1) - q(2)) - p.l(2)*p.l(3)*p.m(3)*q(5)*q(6)*sin(q(2) - q(3));
Vd(3) =(981*p.l(3)*p.m(3)*sin(q(3)))/100 + p.l(1)*p.l(3)*p.m(3)*q(4)*q(6)*sin(q(1) - q(3)) + p.l(2)*p.l(3)*p.m(3)*q(5)*q(6)*sin(q(2) - q(3));
end