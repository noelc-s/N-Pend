function dq = pendOde(t,q,p)
dq = q;
t_1=q(1,:);
td_1=q(3,:);
t_2=q(2,:);
td_2=q(4,:);
u=p.controller(t,q,p);
u_1=u(1,:);
u_2=u(2,:);
dq(1,:)=q(3,:);
dq(2,:)=q(4,:);
dq(3,:)=-(100.*p.l(1).*u_2.*cos(t_1 - t_2) - 100.*p.l(2).*u_1 - 100.*p.b(1).*p.l(2).*td_1 + 981.*p.l(1).*p.l(2).*p.m(1).*sin(t_1) + 981.*p.l(1).*p.l(2).*p.m(2).*sin(t_1) + 100.*p.b(2).*p.l(1).*td_2.*cos(t_1 - t_2) - 981.*p.l(1).*p.l(2).*p.m(2).*cos(t_1 - t_2).*sin(t_2) + 100.*p.l(1).*p.l(2).^2.*p.m(2).*td_2.^2.*sin(t_1 - t_2) + 100.*p.l(1).^2.*p.l(2).*p.m(2).*td_1.^2.*cos(t_1 - t_2).*sin(t_1 - t_2))/(100.*p.l(1).^2.*p.l(2).*(p.m(1) + p.m(2) - p.m(2).*cos(t_1 - t_2).^2));
dq(4,:)=(100.*p.l(1).*p.m(1).*u_2 + 100.*p.l(1).*p.m(2).*u_2 + 100.*p.b(2).*p.l(1).*p.m(1).*td_2 + 100.*p.b(2).*p.l(1).*p.m(2).*td_2 - 100.*p.l(2).*p.m(2).*u_1.*cos(t_1 - t_2) - 981.*p.l(1).*p.l(2).*p.m(2).^2.*sin(t_2) - 100.*p.b(1).*p.l(2).*p.m(2).*td_1.*cos(t_1 - t_2) + 100.*p.l(1).^2.*p.l(2).*p.m(2).^2.*td_1.^2.*sin(t_1 - t_2) + 981.*p.l(1).*p.l(2).*p.m(2).^2.*cos(t_1 - t_2).*sin(t_1) - 981.*p.l(1).*p.l(2).*p.m(1).*p.m(2).*sin(t_2) + 981.*p.l(1).*p.l(2).*p.m(1).*p.m(2).*cos(t_1 - t_2).*sin(t_1) + 100.*p.l(1).*p.l(2).^2.*p.m(2).^2.*td_2.^2.*cos(t_1 - t_2).*sin(t_1 - t_2) + 100.*p.l(1).^2.*p.l(2).*p.m(1).*p.m(2).*td_1.^2.*sin(t_1 - t_2))/(100.*p.l(1).*p.l(2).^2.*p.m(2).*(p.m(1) + p.m(2) - p.m(2).*cos(t_1 - t_2).^2));
end